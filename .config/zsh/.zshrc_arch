#!/bin/zsh
# This script is exclusively for Arch Linux based

if [ -f /etc/os-release ]; then
	. /etc/os-release
	if [ "$ID" != "arch" ]; then
		echo "This script is exclusively for Arch Linux based"
        return
	fi
fi

if ! command -v yay &>/dev/null; then
    sudo pacman -Syu --needed base-devel git
    git clone https://aur.archlinux.org/yay.git &&\
        cd yay && makepkg -si && cd .. && rm -rf yay
    echo "Installed yay on you arch linux"
fi

if [ -f $HOME/.asdf/asdf.sh ]; then
	. $HOME/.asdf/asdf.sh
else
	git clone https://github.com/asdf-vm/asdf.git ~/.asdf --branch v0.14.0
	. $HOME/.asdf/asdf.sh
fi

if ! command -v nvim &>/dev/null; then
    sudo pacman -Sy neovim
fi

if ! command -v tmux &>/dev/null; then
    sudo pacman -Sy tmux
fi

if ! command -v rg &>/dev/null; then
    sudo pacman -Sy ripgrep
fi

if ! command -v cmake &>/dev/null; then
    sudo pacman -Sy cmake
fi

if ! command -v cargo &>/dev/null; then
    sudo pacman -Sy cargo
fi
export PATH=$PATH:~/.cargo/bin/

if ! command -v alacritty &>/dev/null; then
    sudo pacman -Sy alacritty
fi

if ! command -v zoxide &>/dev/null; then
	cargo install zoxide
fi
eval "$(zoxide init zsh)"

if ! command -v lazygit &>/dev/null; then
    sudo pacman -Sy lazygit
fi

function setup() {
	fonts_dir="${HOME}/.local/share/fonts"
	if [ ! -d "${fonts_dir}" ]; then
		echo "Creating dir for Fonts: $fonts_dir"
		mkdir -p "${fonts_dir}"
	fi

	if [ ! -f "${fonts_dir}/FiraCodeNerdFont-Regular.ttf" ]; then
		echo "Downloading FiraCode Nerd Font"
		url_firacodenerdfont="https://github.com/ryanoasis/nerd-fonts/releases/download/v3.1.1/FiraCode.zip"
		zip="FiraCode.zip"
		curl --fail --location --show-error ${url_firacodenerdfont} --output ${zip}
		unzip -o -q -d ${fonts_dir} ${zip}
		rm ${zip}
		fc-cache -f
		echo "FiraCode Nerd Font installed"
	fi
}
